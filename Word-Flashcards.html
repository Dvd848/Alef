<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Word Flashcards</title>
    <link rel="stylesheet"
          href="https://fonts.googleapis.com/css2?family=Noto+Serif+Hebrew">
    <link rel="stylesheet" href="css/flashcards.css">
</head>
<body>

    <div id="settings_menu">
        <a href="javascript:void(0)" id="show_settings">
            <img src="images/settings.png" style="width: 25px">
        </a>
    </div>
    <div class="center" id="card">
        <p id="card_content" class="font_dfus content_word"></p>
    </div>

    <div id="settings">
        <h1>专转</h1>

        <h2>拽</h2>
        <div id="niqqud"></div>

        <div id="settings_buttons">
            <button id="settings_ok">砖专</button>
            <button id="settings_cancel"></button>
        </div>
    </div>

    <script src="js/flashcards.js"></script>
    <script>
    const wordList = `
    植执专止
    址拽职址专职旨
    职指指
    址专职侄
    址专职值
    职执指
    址专职指
    址旨指指
    植指指
    住指职转指
    住址旨指
    执旨指
    址旨指
    旨址专职指
    旨址执转
    址职旨址职指
    旨指
    旨址旨指指
    旨指止
    植执
    旨职专止砖
    砖侄旨址旨旨
    旨职专值指
    旨职专止侄
    旨址专职旨旨专
    注址职旨指专
    旨址专职旨址执
    旨职指执
    址职执址
    旨止址注
    砖侄址注
    注址职指执旨指
    旨址职旨指
    指指
    值
    旨止指
    旨址职旨址
    址旨指砖
    旨址
    旨址专职旨址执
    砖侄旨执
    址职值
    旨指
    旨职执指
    指
    `;

    function populateWords(settings, words) {
        words.length = 0;
        const wordArray = wordList.split(/\r?\n/).map((value) => {return value.trim()});

        const disallowedNiqqud = [];
        for (let i = 0; i < niqqudCharacters.length; ++i) {
            if (!settings.getAllowed("niqqud", i)) {
                disallowedNiqqud.push(niqqudCharacters[i]);
            }
        }

        const pattern = new RegExp(disallowedNiqqud.join('|'));

        for (let word of wordArray) {
            if (word == "") {
                continue;
            }

            if (disallowedNiqqud.length > 0 && pattern.test(word)) {
                continue;
            }

            words.push(word);
        }

        console.log(words);
    }

    function displayRandomWord(settings, words) {
        const wordElement = document.getElementById('card_content');
        if (words.length == 0) {
            wordElement.textContent = '';
            return;
        }

        const randomWord = getRandomArrayElement(words);
        wordElement.textContent = randomWord;
    }

    function init() {
        const settings = setup();

        const words = [];

        populateWords(settings, words);

        displayRandomWord(settings, words);
        document.getElementById("card").addEventListener('click', function(){
            displayRandomWord(settings, words);
        });
        document.addEventListener('keydown', function(event) {
            if (event.key === ' ') {
                displayRandomWord(settings, words);
            }
        });
        document.addEventListener(Settings.eventSettingsSaved, function(){
            words.length = 0;
            populateWords(settings, words);
            displayRandomWord(settings, words);
        }, false);
    }

    document.addEventListener("DOMContentLoaded", init);
    </script>

</body>
</html>